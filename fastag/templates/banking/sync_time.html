{% extends 'base.html' %}
{% block title %}Sync Time - Banking{% endblock %}
{% block content %}
<style>
  .btn-purple { background: #764ba2; color: #fff; border: none; }
  .btn-purple:hover, .btn-purple:focus { background: #5a357d; color: #fff; }
  .card-header-purple { background: #764ba2; color: #fff; font-weight: 600; }
  .card-title, .fa-clock { color: #764ba2; }
</style>
<div class="container mt-4" style="max-width: 500px;">
  <div class="card shadow-sm">
    <div class="card-body">
      <h4 class="card-title mb-3"><i class="fas fa-clock me-2"></i>Sync Time</h4>
      <form method="post" autocomplete="off">
        <div class="mb-2 input-group">
          <span class="input-group-text"><i class="fas fa-building"></i></span>
          <input type="text" class="form-control" id="orgId" name="orgId" value="{{ orgId }}" placeholder="Org ID">
        </div>
        <div class="mb-2 input-group">
          <span class="input-group-text"><i class="fas fa-key"></i></span>
          <input type="text" class="form-control" id="msgId" name="msgId" value="{{ msgId }}" placeholder="Message ID">
        </div>
        <div class="mb-2 input-group">
          <span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
          <input type="text" class="form-control" id="ts" name="ts" value="{{ ts }}" placeholder="Timestamp">
        </div>
        <button type="submit" class="btn btn-purple w-100 mt-2"><i class="fas fa-paper-plane me-1"></i>Send Sync Time</button>
      </form>
    </div>
  </div>
  {% if response %}
  <div class="card mt-4 border-purple" style="border-color:#764ba2 !important;">
    <div class="card-header card-header-purple"><i class="fas fa-check-circle me-1"></i>Response</div>
    <div class="card-body">
      <div id="response">{{ response|safe }}</div>
    </div>
  </div>
  {% endif %}
</div>
<script>
// Autofill timestamp with current time if field is AUTO or empty
window.addEventListener('DOMContentLoaded', function() {
  var tsInput = document.getElementById('ts');
  if (tsInput && (!tsInput.value || tsInput.value === 'AUTO')) {
    var now = new Date();
    var pad = n => n.toString().padStart(2, '0');
    var ts = now.getFullYear() + '-' + pad(now.getMonth()+1) + '-' + pad(now.getDate()) + 'T' + pad(now.getHours()) + ':' + pad(now.getMinutes()) + ':' + pad(now.getSeconds());
    tsInput.value = ts;
  }
});
</script>
{% endblock %} 